# smolit_dev_pkg (sd)

**sd** ist ein schlanker Dev-Orchestrator:  
ğŸ‘‰ Startet **OpenHands** (Docker), verbindet **MCP (Sequential Thinking + Memory)** und bietet eine **Claude-Bridge** per HTTP.  
Dazu kommt eine **CLI** mit nÃ¼tzlichen Subcommands fÃ¼r Entwickler*innen und Microagent-Templates.  
Das Paket ist auÃŸerdem eng mit dem **VoiceAssistant (va)** Projekt integriert.

---

## ğŸš€ Quickstart

```bash
npm install -g .
sd deps doctor
sd up          # Startet OpenHands (Docker) + Bridge
sd status      # Health-Check (GUI, MCP, Bridge)
````

GUI: [http://127.0.0.1:3311](http://127.0.0.1:3311)
Bridge: [http://127.0.0.1:8815/healthz](http://127.0.0.1:8815/healthz)

---

## âš™ï¸ Installation & Setup

### 1. Environment

```bash
cp env.example ~/.config/smolit_dev/.env
```

oder mit:

```bash
sd keys init   # (optional, falls implementiert)
```

### 2. Docker

* OpenHands Container (`openhands/supergateway`) wird automatisch gestartet.
* Ports:

  * GUI: `3311`
  * MCP Sequential: `8811`
  * MCP Memory: `8812`
  * sd-Bridge: `8815`

### 3. Node.js

* Erfordert Node >= 18
* Installiert sich als globales CLI (`sd`).

---

## ğŸ”„ Die sd-Pipeline

Die `sd`-Pipeline verbindet Eingaben, Analyse und KI-Tools:

1. **User Input (unstrukturiert)**
   *Der/die Entwickler*in oder ein Workflow liefert einen Text oder eine Datei.\*

2. **OpenHands (strukturierend)**

   * LÃ¤uft in Docker
   * Erkennt Intentionen und strukturiert unklare Eingaben
   * Baut daraus einen validierten Prompt

3. **Claude als Supervisor**

   * EmpfÃ¤ngt den strukturierten Prompt von OpenHands
   * Agiert als â€Supervisorâ€œ und orchestriert die Arbeit
   * Entscheidet, welche Tools/Aktionen erforderlich sind

4. **Codex als Worker**

   * Claude beauftragt Codex (oder ein anderes Modell) mit konkreten Aufgaben
   * Codex fÃ¼hrt Code-Analysen, Patch-Erstellung und Refactorings durch
   * Ergebnisse werden zurÃ¼ck in den Pipeline-Kontext gespielt

5. **Memory (MCP)**

   * Erkenntnisse und Ergebnisse werden ins MCP Memory geschrieben
   * Bleiben fÃ¼r spÃ¤tere Iterationen abrufbar

Ergebnis: **Von unstrukturiertem Userinput â†’ strukturierter Prompt â†’ konkrete Patches & Next Steps.**

---

## ğŸ–¥ï¸ CLI

```bash
sd up              # OpenHands + Bridge starten, GUI Ã¶ffnen
sd start           # wie 'up', ohne GUI-Open
sd stop            # Container & Bridge stoppen
sd status          # Health-Check
sd logs            # zeigt Log-Verzeichnis
sd deps doctor     # prÃ¼ft Dependencies
sd ports doctor    # Port-Kollisionen prÃ¼fen

sd project init    # .claude/settings.json fÃ¼r MCP erzeugen
sd mcp status      # MCP-Status prÃ¼fen

sd analyze         # Repo-Analyse starten
sd va index        # VoiceAssistant indexieren (Knowledge-Map)
sd va test         # Tests laufen lassen + Patches
sd va next         # nÃ¤chste Schritte erzeugen
```

---

## ğŸ”’ Sicherheit

* **StandardmÃ¤ÃŸig KEIN** `--dangerously-skip-permissions`.
* Optional via `SD_BYPASS_PERMISSIONS=1` aktivierbar.
* Bridge erlaubt nur Tools:

  ```bash
  SD_ALLOWED_TOOLS="sequential-thinking,memory-shared,memory,codex-bridge"
  ```

---

## ğŸ§© Integration

### Flowise

* Custom Tool Node: `sdBridge` (â†’ `http://127.0.0.1:8815/run?prompt=â€¦`)
* Healthcheck Node fÃ¼r Bridge
* Buttons fÃ¼r `va index/test/next`

### n8n

* Webhook â†’ Bridge Proxy (beliebige Prompts/Dateien)
* Cron-Healthcheck â†’ Memory speichern
* GitHub Push â†’ Repo-Analyse
* Buttons fÃ¼r VoiceAssistant (`/va/index`, `/va/test`, `/va/next`)

---

## ğŸ“‚ Struktur

```
bin/sd              # CLI Entry
bin/bridge.mjs      # HTTP Bridge (Claude/MCP)
bin/postinstall.mjs # Idempotentes Setup
templates/          # Microagent-Templates
env.example         # Beispiel-Env
```

---

## ğŸ§‘â€ğŸ’» Developer Guide

* **Linting**:

  ```bash
  npm run lint:shell
  npm run lint:node
  ```
* **CI Smoke-Test**:

  ```bash
  npm run ci:smoke
  ```
* **Packaging-Test**:

  ```bash
  npm pack
  ```

---

## ğŸ“– User Handbook

### Starten

```bash
sd up
```

Ã–ffnet GUI + startet Bridge. Danach kÃ¶nnen Prompts via Flowise oder n8n durchgereicht werden.

### Typische Probleme

* **Port belegt** â†’ `sd ports doctor`
* **Docker nicht lÃ¤uft** â†’ `systemctl start docker`
* **Bridge EPIPE** â†’ wird automatisch mit Retry behandelt

### Logs

```bash
~/.local/state/smolit_dev/logs/
```

### Uninstall

```bash
npm uninstall -g .
rm -rf ~/.config/smolit_dev ~/.local/state/smolit_dev ~/.cache/smolit_dev
```

---

## ğŸ“œ License

MIT License

---

