# Backup Parity

| bak_file | active_file | differences | risk | action |
|---|---|---|---|---|
| bin/bridge.mjs.bak.auto | bin/bridge.mjs | --- bin/bridge.mjs	2025-09-01 10:12:14.168524900 +0200 +++ bin/bridge.mjs.bak.auto	2025-08-31 14:59:40.892949255 +0200 @@ -1,109 +1,89 @@ #!/usr/bin/env node import http from "node:http"; +import { readFileSync, existsSync } from "node:fs"; import { spawn } from "node:child_process"; -import { readFile } from "node:fs/promises"; -import { URL } from "node:url"; -import path from "node:path"; - -const arg = (flag, fallback) => { - const i = process.argv.indexOf(flag); - return i !== -1 ? process.argv[i + 1] : fallback; -}; - -const PORT = Number(process.env.BRIDGE_PORT \|\| arg("--port", 8815)); -const WORKSPACE = process.env.WORKSPACE \|\| arg("--workspace", process.cwd()); -const DANGEROUS = process.argv.includes("--dangerously-skip-permissions"); -const ALLOWED = arg("--allowed-tools", process.env.SD_ALLOWED_TOOLS \|\| "sequential-thinking,memory-shared,memory,codex-bridge"); - -const mapWorkspaceFile = (filePath) => { - const norm = path.posix.normalize(filePath); - if (!norm.startsWith("/workspace/")) { - throw new Error(`Pfad muss mit /workspace beginnen: ${filePath}`); - } - const rel = norm.slice("/workspace".length); - const hostPath = path.resolve(path.join(WORKSPACE, rel)); - const wsRoot = path.resolve(WORKSPACE); - if (!hostPath.startsWith(wsRoot)) { - throw new Error("Pfad auÃŸerhalb des WORKSPACE"); - } - return hostPath; -}; +import { fileURLToPath } from "node:url"; +import { dirname, join } from "node:path"; + +const PORT = parseInt(process.env.CLAUDE_BRIDGE_PORT \|\| "8815", 10); +const WORKSPACE = process.env.WORKSPACE_ROOT \|\| `${process.env.HOME}/OpenHands_Workspace`; +const CLAUDE_MD = process.env.CLAUDE_MD_PATH \|\| `${process.env.HOME}/CLAUDE.md`;  | high | merge |
| bin/sd.bak | bin/sd | --- bin/sd	2025-09-01 09:57:48.295533189 +0200 +++ bin/sd.bak	2025-08-31 15:01:00.095892367 +0200 @@ -1,557 +1,386 @@ #!/usr/bin/env bash -# ============================================================================== -# sd â€” smolit_dev CLI -# One-command Dev-Stack: OpenHands (Docker) + MCP (SSE) + Claude & Codex Bridge -# Features: -# â€¢ sd up / start / stop / status / logs [-f] / ports doctor / deps {install,install-global,doctor} -# â€¢ sd project init / sd init / sd mcp status -# â€¢ sd analyze / sd index / sd test / sd next -# â€¢ sd keys init / sd llm {list,use <id>} -# â€¢ sd start-repl / sd send init "â€¦" / sd send c "â€¦" / sd c "â€¦" -# Requirements: bash, docker, node>=18, curl (jq optional) -# Cross-platform: Linux, macOS; Windows via Node-Launcher + Git Bash -# ============================================================================== - -set -Eeuo pipefail -IFS=$'\n\t' - -# ===== Colors ===== -if [[ -t 1 ]]; then - cCyan=$'\e[36m'; cYel=$'\e[33m'; cRed=$'\e[31m'; cDim=$'\e[2m'; cOff=$'\e[0m' -else - cCyan=""; cYel=""; cRed=""; cDim=""; cOff="" -fi -log() { echo -e "${cCyan}[sd]${cOff} $*"; } -warn() { echo -e "${cYel}[sd warn]${cOff} $*" >&2; } -die() { echo -e "${cRed}[sd err]${cOff} $*" >&2; exit 1; } -need() { command -v "$1" >/dev/null 2>&1 \|\| die "Missing dependency: $1"; } - -# ===== Banner ===== -banner() { - cat <<'BANNER' - ____ __ __ ____ _ ___ _____ - / ___\| \| \/ \| / __ \ \| \| \|_ _\| \|_ _\| - \___ \ \| \|\/\| \| \| \| \| \| \| \| \| \| \| \| - ___) \| \| \| \| \| \| \|__\| \| \| \|___ \| \| \| \| - \|____/ \|_\| \|_\| \____/ \|_____\| \|___\| \|_\| _dev -  | high | merge |
| bin/sd.bak.keepmem | bin/sd | --- bin/sd	2025-09-01 09:57:48.295533189 +0200 +++ bin/sd.bak.keepmem	2025-08-31 15:51:31.989856957 +0200 @@ -1,557 +1,386 @@ #!/usr/bin/env bash -# ============================================================================== -# sd â€” smolit_dev CLI -# One-command Dev-Stack: OpenHands (Docker) + MCP (SSE) + Claude & Codex Bridge -# Features: -# â€¢ sd up / start / stop / status / logs [-f] / ports doctor / deps {install,install-global,doctor} -# â€¢ sd project init / sd init / sd mcp status -# â€¢ sd analyze / sd index / sd test / sd next -# â€¢ sd keys init / sd llm {list,use <id>} -# â€¢ sd start-repl / sd send init "â€¦" / sd send c "â€¦" / sd c "â€¦" -# Requirements: bash, docker, node>=18, curl (jq optional) -# Cross-platform: Linux, macOS; Windows via Node-Launcher + Git Bash -# ============================================================================== - -set -Eeuo pipefail -IFS=$'\n\t' - -# ===== Colors ===== -if [[ -t 1 ]]; then - cCyan=$'\e[36m'; cYel=$'\e[33m'; cRed=$'\e[31m'; cDim=$'\e[2m'; cOff=$'\e[0m' -else - cCyan=""; cYel=""; cRed=""; cDim=""; cOff="" -fi -log() { echo -e "${cCyan}[sd]${cOff} $*"; } -warn() { echo -e "${cYel}[sd warn]${cOff} $*" >&2; } -die() { echo -e "${cRed}[sd err]${cOff} $*" >&2; exit 1; } -need() { command -v "$1" >/dev/null 2>&1 \|\| die "Missing dependency: $1"; } - -# ===== Banner ===== -banner() { - cat <<'BANNER' - ____ __ __ ____ _ ___ _____ - / ___\| \| \/ \| / __ \ \| \| \|_ _\| \|_ _\| - \___ \ \| \|\/\| \| \| \| \| \| \| \| \| \| \| \| - ___) \| \| \| \| \| \| \|__\| \| \| \|___ \| \| \| \| - \|____/ \|_\| \|_\| \____/ \|_____\| \|___\| \|_\| _dev -  | high | merge |
| bin/sd.bak.new | bin/sd | --- bin/sd	2025-09-01 09:57:48.295533189 +0200 +++ bin/sd.bak.new	2025-09-01 08:18:19.946759728 +0200 @@ -1,51 +1,29 @@ #!/usr/bin/env bash -# ============================================================================== -# sd â€” smolit_dev CLI -# One-command Dev-Stack: OpenHands (Docker) + MCP (SSE) + Claude & Codex Bridge -# Features: -# â€¢ sd up / start / stop / status / logs [-f] / ports doctor / deps {install,install-global,doctor} -# â€¢ sd project init / sd init / sd mcp status -# â€¢ sd analyze / sd index / sd test / sd next -# â€¢ sd keys init / sd llm {list,use <id>} -# â€¢ sd start-repl / sd send init "â€¦" / sd send c "â€¦" / sd c "â€¦" -# Requirements: bash, docker, node>=18, curl (jq optional) -# Cross-platform: Linux, macOS; Windows via Node-Launcher + Git Bash -# ============================================================================== - +# sd â€” One-command Dev-Stack (OpenHands + MCP + Claude-Bridge) +# Robust CLI for starting/stopping the stack and running repo-centric AI helpers. set -Eeuo pipefail IFS=$'\n\t' -# ===== Colors ===== +# ===== Trap & Strictness ===== +cleanup() { + # nothing persistent to clean; placeholder for future temp-files + : +} +trap cleanup EXIT + +# ===== Colors (fallback if not TTY) ===== if [[ -t 1 ]]; then cCyan=$'\e[36m'; cYel=$'\e[33m'; cRed=$'\e[31m'; cDim=$'\e[2m'; cOff=$'\e[0m' else cCyan=""; cYel=""; cRed=""; cDim=""; cOff="" fi + log() { echo -e "${cCyan}[sd]${cOff} $*"; } warn() { echo -e "${cYel}[sd warn]${cOff} $*" >&2; } die() { echo -e "${cRed}[sd err]${cOff} $*" >&2; exit 1; }  | high | merge |
| bin/sd.bak.new2 | bin/sd | --- bin/sd	2025-09-01 09:57:48.295533189 +0200 +++ bin/sd.bak.new2	2025-09-01 08:40:11.785515317 +0200 @@ -1,20 +1,13 @@ #!/usr/bin/env bash -# ============================================================================== -# sd â€” smolit_dev CLI -# One-command Dev-Stack: OpenHands (Docker) + MCP (SSE) + Claude & Codex Bridge -# Features: -# â€¢ sd up / start / stop / status / logs [-f] / ports doctor / deps {install,install-global,doctor} -# â€¢ sd project init / sd init / sd mcp status -# â€¢ sd analyze / sd index / sd test / sd next -# â€¢ sd keys init / sd llm {list,use <id>} -# â€¢ sd start-repl / sd send init "â€¦" / sd send c "â€¦" / sd c "â€¦" -# Requirements: bash, docker, node>=18, curl (jq optional) -# Cross-platform: Linux, macOS; Windows via Node-Launcher + Git Bash -# ============================================================================== - +# sd â€” One-command Dev-Stack (OpenHands + MCP + Claude-Bridge) +# Robust CLI for starting/stopping the stack, sending prompts, and repo-centric AI helpers. set -Eeuo pipefail IFS=$'\n\t' +# ===== Trap ===== +cleanup() { :; } +trap cleanup EXIT + # ===== Colors ===== if [[ -t 1 ]]; then cCyan=$'\e[36m'; cYel=$'\e[33m'; cRed=$'\e[31m'; cDim=$'\e[2m'; cOff=$'\e[0m' @@ -26,25 +19,6 @@ die() { echo -e "${cRed}[sd err]${cOff} $*" >&2; exit 1; } need() { command -v "$1" >/dev/null 2>&1 \|\| die "Missing dependency: $1"; } -# ===== Banner ===== -banner() { - cat <<'BANNER' - ____ __ __ ____ _ ___ _____ - / ___\| \| \/ \| / __ \ \| \| \|_ _\| \|_ _\| - \___ \ \| \|\/\| \| \| \| \| \| \| \| \| \| \| \| - ___) \| \| \| \| \| \| \|__\| \| \| \|___ \| \| \| \|  | high | merge |
| README.md.bak2 | README.md | --- ./README.md	2025-09-01 09:14:57.636966000 +0200 +++ README.md.bak2	2025-09-01 08:04:24.182290143 +0200 @@ -3,6 +3,7 @@ **sd** ist ein schlanker Dev-Orchestrator: ðŸ‘‰ Startet **OpenHands** (Docker), verbindet **MCP (Sequential Thinking + Memory)** und bietet eine **Claude-Bridge** per HTTP. Dazu kommt eine **CLI** mit nÃ¼tzlichen Subcommands fÃ¼r Entwickler*innen und Microagent-Templates. +Das Paket ist auÃŸerdem eng mit dem **VoiceAssistant (va)** Projekt integriert. --- @@ -56,33 +57,33 @@ Die `sd`-Pipeline verbindet Eingaben, Analyse und KI-Tools: 1. **User Input (unstrukturiert)** - *Einfacher Text oder Datei-Inhalt.* + *Der/die Entwickler*in oder ein Workflow liefert einen Text oder eine Datei.\* ---- 2. **OpenHands (strukturierend)** + * LÃ¤uft in Docker * Erkennt Intentionen und strukturiert unklare Eingaben * Baut daraus einen validierten Prompt ---- 3. **Claude als Supervisor** + * EmpfÃ¤ngt den strukturierten Prompt von OpenHands * Agiert als â€žSupervisorâ€œ und orchestriert die Arbeit * Entscheidet, welche Tools/Aktionen erforderlich sind ---- 4. **Codex als Worker** + * Claude beauftragt Codex (oder ein anderes Modell) mit konkreten Aufgaben * Codex fÃ¼hrt Code-Analysen, Patch-Erstellung und Refactorings durch * Ergebnisse werden zurÃ¼ck in den Pipeline-Kontext gespielt ---- 5. **Memory (MCP)**  | med | merge |
